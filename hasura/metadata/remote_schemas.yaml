- name: controller
  definition:
    url_from_env: CONTROLLER_URL
    timeout_seconds: 60
    customization: {}
    forward_client_headers: true
  permissions:
    - role: user
      definition:
        schema: |
          schema {
            query: Query
            mutation: Mutation
          }
          scalar uuid
          type Mutation {
            cancelRun(runId: uuid!): Run
            createRun(run: CreateRunInput!): Run!
            startRun(runId: uuid!): Run
          }
          type Query {
            computeUploadPresignedUrl: String!
            ping: String!
            username: String!
          }
          type Run {
            runId: uuid!
          }
          input CreateRunInput {
            environmentVariables: [StepEnvironmentVariable!]
            name: String!
            simulationId: uuid!
            timeouts: [StepTimeout!]
          }
          input StepEnvironmentVariable {
            name: String!
            stepName: String!
            value: String!
          }
          input StepTimeout {
            stepName: String!
            timeout: Int!
          }
  remote_relationships:
    - relationships:
        - definition:
            to_source:
              field_mapping:
                runId: run_id
              relationship_type: object
              source: default
              table:
                name: runs
                schema: simpipe
          name: Run
      type_name: Run
